{% extends "base.html" %}

{% block head %}
<!-- Load the documentation CSS -->
<link rel="stylesheet" href="{{ url_for('static', filename='css/other.css') }}">
{% endblock %}

{% block content %}
<div class="docs-layout">
    
    <!-- SIDEBAR -->
    <aside class="docs-sidebar">
        <h3>INSERT Guide</h3>
        <ul>
            <li><a href="#overview">Overview</a></li>
            <li><a href="#syntax">Syntax</a></li>
            <li><a href="#basic-examples">Basic Examples</a></li>
            <li><a href="#multiple-rows">Multiple Rows</a></li>
            <li><a href="#insert-select">Insert from SELECT</a></li>
            <li><a href="#data-types">Data Types</a></li>
            <li><a href="#serial-columns">SERIAL Columns</a></li>
            <li><a href="#foreign-keys">Foreign Keys</a></li>
            <li><a href="#pitfalls">Common Pitfalls</a></li>
            <li><a href="#comparison">DML Comparison</a></li>
        </ul>

        <h3>Related Commands</h3>
        <ul>
            <li><a href="{{ url_for('main.select') }}">SELECT</a></li>
            <li><a href="{{ url_for('main.update') }}">UPDATE</a></li>
            <li><a href="{{ url_for('main.delete') }}">DELETE</a></li>
        </ul>
    </aside>

    <!-- MAIN CONTENT -->
    <main class="docs-content">
        <h1>INSERT Command</h1>
        <p><strong>Data Manipulation Language (DML)</strong> — Add new rows of data into a table.</p>

        <section id="overview">
            <h2>Overview</h2>
            <p>The <code>INSERT</code> statement is used to add new records to a database table. You must specify the target table, the columns you wish to populate, and the corresponding values for those columns.</p>
            <div class="info-box">
                <strong>ℹ️ Note:</strong> The order of values in the <code>VALUES</code> clause must exactly match the order of columns specified in the column list.
            </div>
        </section>

        <section id="syntax">
            <h2>Syntax</h2>
            <p>MaazDB supports three primary ways to insert data:</p>
            <span class="code-label">Standard Insert</span>
            <pre><code>INSERT INTO &lt;table_name&gt; (column1, column2) VALUES (value1, value2);</code></pre>
            
            <span class="code-label">Multiple Rows</span>
            <pre><code>INSERT INTO &lt;table_name&gt; (column1, column2) VALUES 
(value1, value2), 
(value3, value4);</code></pre>

            <span class="code-label">Insert from Select</span>
            <pre><code>INSERT INTO &lt;table_name&gt; (column1, column2) 
SELECT columnA, columnB FROM &lt;other_table&gt; [WHERE condition];</code></pre>
        </section>

        <section id="basic-examples">
            <h2>Basic Examples</h2>

            <h3>Simple Insert</h3>
            <p>Adding a user with a name and age:</p>
            <span class="code-label">Example</span>
            <pre><code>INSERT INTO users (username, age) VALUES ('Alice', 30);</code></pre>

            <h3>Insert with All Supported Types</h3>
            <p>Inserting a product with text, double, boolean, and timestamp data:</p>
            <span class="code-label">Example</span>
            <pre><code>INSERT INTO products (name, price, is_active, created_at) 
VALUES ('Gaming Mouse', 59.99, TRUE, '2024-01-15 14:30:00');</code></pre>
        </section>

        <section id="multiple-rows">
            <h2>Inserting Multiple Rows</h2>
            <p>You can insert multiple records in a single query by providing comma-separated groups of values enclosed in parentheses. This is highly recommended for bulk inserts as it significantly improves performance by reducing network round-trips.</p>
            <span class="code-label">Example</span>
            <pre><code>INSERT INTO products (name, price, is_active) VALUES 
('Mechanical Keyboard', 120.00, TRUE),
('4K Monitor', 399.99, TRUE),
('Mousepad', 15.50, FALSE);</code></pre>
        </section>

        <section id="insert-select">
            <h2>Insert from SELECT</h2>
            <p>You can populate a table using the results of a <code>SELECT</code> query from another table. This is incredibly useful for archiving data, creating backups, or transforming data between tables.</p>
            <div class="info-box">
                <strong>ℹ️ Note:</strong> The data types of the columns returned by the <code>SELECT</code> statement must match the columns specified in the <code>INSERT</code> statement.
            </div>
            <span class="code-label">Example</span>
            <pre><code>-- Archive inactive users into the 'archived_users' table
INSERT INTO archived_users (user_id, name, email)
SELECT id, name, email FROM users WHERE is_active = FALSE;</code></pre>
        </section>

        <section id="data-types">
            <h2>Handling Data Types</h2>
            <p>MaazDB supports specific formatting for different data types during insertion.</p>

            <h3>Strings (TEXT)</h3>
            <p>Enclose strings in single (<code>'</code>) or double (<code>"</code>) quotes.</p>
            <pre><code>INSERT INTO logs (message) VALUES ('System started successfully');</code></pre>

            <h3>Numbers (INT, DOUBLE)</h3>
            <p>Enter numbers directly without quotes.</p>
            <pre><code>INSERT INTO measurements (temperature, pressure) VALUES (23.5, 1013);</code></pre>

            <h3>Booleans (BOOL)</h3>
            <p>Use <code>TRUE</code> or <code>FALSE</code> (case-insensitive).</p>
            <pre><code>INSERT INTO tasks (completed) VALUES (FALSE);</code></pre>

            <h3>Timestamps (TIMESTAMP)</h3>
            <p>Must follow the exact format <code>'YYYY-MM-DD HH:MM:SS'</code> enclosed in quotes.</p>
            <pre><code>INSERT INTO events (event_time) VALUES ('2023-12-31 23:59:59');</code></pre>
        </section>

        <section id="serial-columns">
            <h2>Handling SERIAL Columns</h2>
            <p>If a table has a primary key defined as <code>SERIAL</code> (auto-incrementing integer), you <strong>must not</strong> include it in the <code>INSERT</code> statement.</p>
            
            <div class="warning-box">
                <strong>⚠️ Important:</strong> Do not attempt to manually insert a value into a SERIAL column. The database handles this automatically.
            </div>

            <span class="code-label">Correct Usage</span>
            <pre><code>-- Table 'users' has columns: id (SERIAL), name (TEXT)
INSERT INTO users (name) VALUES ('Bob'); 
-- 'id' will be automatically generated (e.g., 1, 2, 3...)</code></pre>
        </section>

        <section id="foreign-keys">
            <h2>Foreign Key Constraints</h2>
            <p>When inserting into a column that is a <code>FOREIGN KEY</code>, the value must already exist in the referenced parent table.</p>

            <span class="code-label">Example Scenario</span>
            <pre><code>-- 1. Parent Table: users (id=1 exists)
-- 2. Child Table: orders (user_id references users.id)

-- ✅ SUCCESS: User 1 exists
INSERT INTO orders (user_id, amount) VALUES (1, 99.99);

-- ❌ FAILURE: User 999 does not exist
INSERT INTO orders (user_id, amount) VALUES (999, 50.00);
-- Error: Foreign key constraint violation</code></pre>
        </section>

        <section id="pitfalls">
            <h2>Common Pitfalls</h2>

            <h3>❌ Column Count Mismatch</h3>
            <p>The number of columns must match the number of values.</p>
            <pre><code>INSERT INTO users (name, age) VALUES ('Alice'); 
-- Error: Expected 2 values, got 1</code></pre>

            <h3>❌ Type Mismatch</h3>
            <p>Trying to insert text into a numeric field.</p>
            <pre><code>INSERT INTO users (age) VALUES ('twenty'); 
-- Error: Cannot parse 'twenty' as INT</code></pre>
        </section>

        <section id="comparison">
            <h2>DML Comparison</h2>
            <table class="custom-table">
                <thead>
                    <tr>
                        <th>Command</th>
                        <th>Purpose</th>
                        <th>Effect</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>INSERT</strong></td>
                        <td>Create</td>
                        <td>Adds new rows to the table.</td>
                    </tr>
                    <tr>
                        <td><strong>UPDATE</strong></td>
                        <td>Modify</td>
                        <td>Changes values in existing rows.</td>
                    </tr>
                    <tr>
                        <td><strong>DELETE</strong></td>
                        <td>Remove</td>
                        <td>Removes rows from the table.</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <!-- Bottom Navigation -->
        <div style="display: flex; justify-content: space-between; margin-top: 50px; padding-top: 20px; border-top: 1px solid var(--border);">
            <a href="{{ url_for('main.docs') }}" class="btn-nav" style="background: var(--bg-card); color: var(--text-main) !important; border: 1px solid var(--border); box-shadow: none;">&larr; Back to Docs</a>
            <a href="{{ url_for('main.select') }}" class="btn-nav">Next: SELECT &rarr;</a>
        </div>
    </main>
</div>
{% endblock %}

{% block scripts %}
   <script src="{{ url_for('static', filename='js/docs.js') }}"></script>
{% endblock %}