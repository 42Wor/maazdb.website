{% extends "base.html" %}

{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/other.css') }}">
<div class="docs-layout">
    
    <!-- SIDEBAR NAVIGATION -->
    <aside class="docs-sidebar">
        <h3>Quick Start</h3>
        <ul>
            <li><a href="#intro">Introduction</a></li>
            <li><a href="#installation">Installation</a></li>
            <li><a href="#protocol">Protocol</a></li>
            <li><a href="#auth">Authentication</a></li>
            <li><a href="#ecosystem">Ecosystem & Drivers</a></li>
        </ul>

        <h3>Database Management</h3>
        <ul>
            <li><a href="#db-mgmt">Databases</a></li>
            <li><a href="#types">Data Types</a></li>
            <li><a href="#create-table">Create Table</a></li>
            <li><a href="#foreign-keys">Foreign Keys</a></li>
            <li><a href="#table-mgmt">Table Management</a></li>
        </ul>

        <h3>Data Operations</h3>
        <ul>
            <li><a href="#insert">Insert</a></li>
            <li><a href="#select">Select</a></li>
            <li><a href="#update">Update</a></li>
            <li><a href="#delete">Delete</a></li>
        </ul>

        <h3>System Operations</h3>
        <ul>
            <li><a href="#backup">Backup & Restore</a></li>
            <li><a href="#comments">Comments & Literals</a></li>
        </ul>

        <h3>Examples</h3>
        <ul>
            <li><a href="#test-suite">Complete Test Suite</a></li>
        </ul>
    </aside>

    <!-- MAIN DOCUMENTATION CONTENT -->
    <main class="docs-content">

        <section id="intro">
            <h1>MaazDB Documentation</h1>
            <p><strong>Version:</strong> {{ version or '12.0.0' }}<br>
            <strong>Default Port:</strong> 8888<br>
            <strong>Protocol:</strong> TCP / Binary Length-Prefixed</p>
            
            <h3>What is MaazDB?</h3>
            <p>MaazDB is a lightweight, high-performance database management system built with modern development workflows in mind. It features a custom binary protocol, full ACID compliance, and an intuitive SQL-like query language.</p>
        </section>

        <!-- INSTALLATION -->
        <section id="installation">
            <h2>Installation</h2>
            
            <h3>Linux (Debian/Ubuntu/Kali)</h3>
            <div class="install-badge">
                <i class="fab fa-linux"></i>
                <code>sudo dpkg -i maazdb_{{ version or '12.0.0' }}_linux_amd64.deb</code>
            </div>
            
            <h3>macOS</h3>
            <div class="install-badge">
                <i class="fab fa-apple"></i>
                <code>Open MaazDB_{{ version or '12.0.0' }}_macOS.dmg</code>
            </div>
            
            <h3>Windows</h3>
            <div class="install-badge">
                <i class="fab fa-windows"></i>
                <code>Run MaazDB_Setup_Windows_x64.exe</code>
            </div>
        </section>

        <!-- 1. PROTOCOL -->
        <section id="protocol">
            <h2>1. Connection Protocol</h2>
            <p>MaazDB uses a custom binary protocol over TCP. Every packet follows this structure:</p>
            <table class="custom-table">
                <thead><tr><th>Byte</th><th>Field</th><th>Description</th></tr></thead>
                <tbody>
                    <tr><td>1</td><td>Type</td><td><code>0x01</code> Command, <code>0x02</code> Msg, <code>0x03</code> Data, <code>0xFF</code> Error</td></tr>
                    <tr><td>4</td><td>Length</td><td>Unsigned 32-bit Integer (Big-Endian)</td></tr>
                    <tr><td>N</td><td>Payload</td><td>UTF-8 String (SQL or JSON Result)</td></tr>
                </tbody>
            </table>
        </section>

        <!-- 2. AUTHENTICATION -->
        <section id="auth">
            <h2>2. Authentication</h2>
            <p>If you've used older versions of MaazDB, you might remember having to send a <code>LOGIN</code> SQL query to authenticate. We've completely revamped this process to make it much more secure and developer-friendly!</p>
            <p>Now, authentication happens entirely under the hood the moment your driver connects to the database. You simply pass your credentials (host, port, username, and password) directly into your language's driver connection method. This ensures that your session is securely authenticated from the very first packet, preventing unauthorized access before any SQL is even parsed.</p>
            
            <span class="code-label">Conceptual Example (Using a Client Driver)</span>
            <pre><code>// No more LOGIN queries! Just pass credentials to your driver:
const db = new MaazDB();
await db.connect("127.0.0.1", 8888, "admin", "admin");</code></pre>
        </section>

        <!-- ECOSYSTEM & DRIVERS -->
        <section id="ecosystem">
            <h2>Ecosystem & Official Drivers</h2>
            <p>MaazDB isn't just a standalone database; it's a growing ecosystem. We know that writing raw TCP sockets isn't fun, so we've built native, highly-optimized drivers for your favorite programming languages.</p>
            <p>Whether you are building a web backend in Node.js, a high-performance system in Rust, or doing data analysis in Python, we have an official library ready for you. These drivers handle all the complex binary protocol packing, TLS encryption, and connection pooling automatically.</p>
            <a href="{{ url_for('main.overview') }}" class="btn btn-primary" style="display: inline-block; margin-top: 10px; padding: 10px 20px; background: var(--accent, #007bff); color: white; text-decoration: none; border-radius: 5px;">Explore Official Drivers & Libraries &rarr;</a>
        </section>

        <!-- 3. DATABASE MANAGEMENT -->
        <section id="db-mgmt">
            <h2>3. Database Management</h2>

            <h3>Create Database</h3>
            <span class="code-label">Syntax</span>
            <pre><code>CREATE DATABASE &lt;db_name&gt;;</code></pre>

            <h3>Use Database</h3>
            <span class="code-label">Syntax</span>
            <pre><code>USE &lt;db_name&gt;;</code></pre>

            <h3>Show Databases</h3>
            <span class="code-label">Syntax</span>
            <pre><code>SHOW DATABASES;</code></pre>

            <h3>Drop Database</h3>
            <span class="code-label">Syntax</span>
            <pre><code>DROP DATABASE &lt;db_name&gt;;</code></pre>
        </section>

        <!-- 4. SCHEMA (DDL) -->
        <section id="types">
            <h2>4. Data Types</h2>
            <table class="custom-table">
                <thead><tr><th>Type</th><th>Description</th></tr></thead>
                <tbody>
                    <tr><td><code>SERIAL</code></td><td>Auto-incrementing Integer (Primary Key only)</td></tr>
                    <tr><td><code>INT</code></td><td>Standard 32-bit Integer</td></tr>
                    <tr><td><code>DOUBLE</code></td><td>64-bit Floating point</td></tr>
                    <tr><td><code>TEXT</code></td><td>UTF-8 String</td></tr>
                    <tr><td><code>BOOL</code></td><td>Boolean (TRUE/FALSE)</td></tr>
                    <tr><td><code>TIMESTAMP</code></td><td>Date and time</td></tr>
                    <tr><td><code>UUID</code></td><td>Universally Unique Identifier</td></tr>
                </tbody>
            </table>
        </section>

        <section id="create-table">
            <h3>Create Table</h3>
            <span class="code-label">Syntax</span>
            <pre><code>CREATE TABLE &lt;table_name&gt; (
    &lt;col_name&gt; &lt;type&gt; [PRIMARY KEY],
    ...
);</code></pre>
        </section>

        <section id="foreign-keys">
            <h3>Foreign Keys</h3>
            <span class="code-label">Syntax</span>
            <pre><code>CREATE TABLE &lt;table_name&gt; (
    ...
    FOREIGN KEY (&lt;local_col&gt;) REFERENCES &lt;parent_table&gt;(&lt;parent_col&gt;)
);</code></pre>
        </section>

        <section id="table-mgmt">
            <h3>Table Management</h3>
            <h4>Show Tables</h4>
            <pre><code>SHOW TABLES;</code></pre>
            <h4>Describe Table</h4>
            <pre><code>DESCRIBE &lt;table_name&gt;;</code></pre>
            <h4>Drop Table</h4>
            <pre><code>DROP TABLE &lt;table_name&gt;;</code></pre>
        </section>

        <!-- 5. DATA MANIPULATION (DML) -->
        <section id="insert">
            <h2>5. Data Manipulation (DML)</h2>
            <h3>Insert</h3>
            <p>Adds new rows to a table. Do not include <code>SERIAL</code> columns in your insert statement, as they auto-increment.</p>
            <span class="code-label">Syntax</span>
            <pre><code>INSERT INTO &lt;table_name&gt; (&lt;col1&gt;, &lt;col2&gt;) VALUES (&lt;val1&gt;, &lt;val2&gt;);</code></pre>
            <a href="{{ url_for('main.insert') }}" style="color: var(--accent, #007bff); text-decoration: underline; font-weight: bold;">Learn more about INSERT &rarr;</a>
        </section>

        <section id="select">
            <h3>Select</h3>
            <p>Retrieves data with powerful filtering capabilities.</p>
            <span class="code-label">Syntax</span>
            <pre><code>SELECT &lt;cols&gt; FROM &lt;table_name&gt; [WHERE condition];</code></pre>
            
            <h4>Aggregate Functions</h4>
            <p>Aggregate functions perform a calculation on a set of values and return a single value. They are incredibly useful for data analysis.</p>
            <table class="custom-table">
                <thead><tr><th>Function</th><th>Description</th></tr></thead>
                <tbody>
                    <tr><td><code>COUNT(column)</code></td><td>Returns the total number of rows matching the criteria.</td></tr>
                    <tr><td><code>SUM(column)</code></td><td>Returns the total sum of a numeric column.</td></tr>
                    <tr><td><code>MAX(column)</code></td><td>Returns the largest (maximum) value of the selected column.</td></tr>
                    <tr><td><code>MIN(column)</code></td><td>Returns the smallest (minimum) value of the selected column.</td></tr>
                </tbody>
            </table>
            
            <span class="code-label">Example</span>
            <pre><code>-- Get the total number of users and the sum of all salaries
SELECT COUNT(*) as total_users, SUM(salary) as total_payroll FROM users;

-- Find the highest and lowest salary in the company
SELECT MAX(salary) as highest_salary, MIN(salary) as lowest_salary FROM users;</code></pre>
            <a href="{{ url_for('main.select') }}" style="color: var(--accent, #007bff); text-decoration: underline; font-weight: bold;">Learn more about SELECT &rarr;</a>
        </section>

        <section id="update">
            <h3>Update</h3>
            <p>Modifies existing data based on a specific condition.</p>
            <span class="code-label">Syntax</span>
            <pre><code>UPDATE &lt;table_name&gt; SET &lt;col&gt; = &lt;val&gt; WHERE &lt;condition&gt;;</code></pre>
            <a href="{{ url_for('main.update') }}" style="color: var(--accent, #007bff); text-decoration: underline; font-weight: bold;">Learn more about UPDATE &rarr;</a>
        </section>

        <section id="delete">
            <h3>Delete</h3>
            <p>Removes rows from a table based on a condition.</p>
            <span class="code-label">Syntax</span>
            <pre><code>DELETE FROM &lt;table_name&gt; WHERE &lt;condition&gt;;</code></pre>
            <a href="{{ url_for('main.delete') }}" style="color: var(--accent, #007bff); text-decoration: underline; font-weight: bold;">Learn more about DELETE &rarr;</a>
        </section>

        <!-- 6. BACKUP & RESTORE -->
        <section id="backup">
            <h2>6. Disaster Recovery</h2>
            <h3>Backup</h3>
            <pre><code>BACKUP '&lt;snapshot_name&gt;';</code></pre>
            <h3>Show Backups</h3>
            <pre><code>SHOW BACKUPS;</code></pre>
            <h3>Restore</h3>
            <pre><code>RESTORE '&lt;snapshot_name&gt;';</code></pre>
        </section>

        <!-- 7. COMMENTS & LITERALS -->
        <section id="comments">
            <h2>7. Comments & Literals</h2>
            <h3>Comments</h3>
            <pre><code>-- This is a single-line comment
/* This is a
   multi-line comment */</code></pre>
        </section>

        <!-- 8. TEST SUITE -->
        <section id="test-suite">
            <h2>Complete Test Suite Example</h2>
            <p>Below is a comprehensive test suite demonstrating all major features of MaazDB. You can run this directly in your client to verify your setup.</p>
            <pre><code>-- MaazDB Comprehensive Test Suite
-- Note: Authentication is handled by the client driver.

-- 1. Database Management
CREATE DATABASE full_test_db;
USE full_test_db;

-- 2. DDL (Schema Creation)
CREATE TABLE employees (
    id SERIAL PRIMARY KEY,
    name TEXT,
    role TEXT,
    salary DOUBLE,
    is_active BOOL
);

-- 3. DML (Data Insertion)
INSERT INTO employees (name, role, salary, is_active) VALUES ('Alice', 'Engineer', 85000.00, TRUE);
INSERT INTO employees (name, role, salary, is_active) VALUES ('Bob', 'Manager', 95000.50, TRUE);
INSERT INTO employees (name, role, salary, is_active) VALUES ('Charlie', 'Intern', 30000.00, FALSE);

-- 4. SELECT with Aggregates
SELECT COUNT(*) as total_staff FROM employees;
SELECT SUM(salary) as total_payroll FROM employees;
SELECT MAX(salary) as highest_paid FROM employees;
SELECT MIN(salary) as lowest_paid FROM employees;

-- 5. UPDATE & DELETE
UPDATE employees SET salary = 90000.00 WHERE name = 'Alice';
DELETE FROM employees WHERE name = 'Charlie';

-- 6. Cleanup
USE system;
DROP DATABASE full_test_db;</code></pre>
        </section>
    </main>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Scroll Spy for Sidebar
    const sidebarLinks = document.querySelectorAll('.docs-sidebar a');
    const sections = document.querySelectorAll('section[id]');
    
    window.addEventListener('scroll', () => {
        let current = '';
        const scrollY = window.pageYOffset + 150;
        
        sections.forEach(section => {
            const sectionTop = section.offsetTop;
            const sectionHeight = section.clientHeight;
            
            if (scrollY >= sectionTop && scrollY < sectionTop + sectionHeight) {
                current = section.getAttribute('id');
            }
        });
        
        sidebarLinks.forEach(link => {
            link.classList.remove('active');
            if (link.getAttribute('href') === `#${current}`) {
                link.classList.add('active');
            }
        });
    });
});
</script>
{% endblock %}